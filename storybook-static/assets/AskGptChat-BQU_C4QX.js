import{j as t}from"./jsx-runtime-D_zvdyIk.js";import{r as o}from"./index-BZISi7jw.js";import"./_commonjsHelpers-CqkleIqs.js";function b(l){const[r,n]=o.useState([]),[s,d]=o.useState(""),[a,e]=o.useOptimistic(!1);return{handleAsk:async()=>{var p,u;if(s.trim()){o.startTransition(()=>{n(i=>[...i,{role:"user",content:s}]),e(!0)});try{const g=((u=(p=(await(await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({model:"gpt-4",messages:[...r,{role:"user",content:s}]})})).json()).choices[0])==null?void 0:p.message)==null?void 0:u.content)||"Pas de rÃ©ponse.";o.startTransition(()=>{n(m=>[...m,{role:"gpt",content:g}])})}catch(i){o.startTransition(()=>{n(h=>[...h,{role:"gpt",content:`Erreur de connexion : ${i}`}])})}e(!1)}},messages:r,question:s,setQuestion:d,isLoading:a}}const x=({REACT_APP_OPENAI_API_KEY:l})=>{const{handleAsk:r,setQuestion:n,question:s,messages:d,isLoading:a}=b(l);return t.jsxs("div",{className:"p-4 border rounded-lg shadow-lg bg-gray-900 text-white w-full max-w-lg",children:[t.jsx("h2",{className:"text-lg font-bold",children:"Chat avec GPT ðŸš€"}),t.jsx("div",{className:"my-4 p-2 h-64 overflow-y-auto border rounded bg-gray-800",children:d.map((e,c)=>t.jsxs("p",{className:`p-2 my-1 rounded ${e.role==="user"?"bg-blue-600 text-white":"bg-gray-700 text-gray-200"}`,children:[t.jsx("strong",{children:e.role==="user"?"ðŸ‘¤ Toi :":"ðŸ¤– GPT :"})," ",e.content]},`${e.role}-${c}`))}),t.jsx("label",{htmlFor:"question",className:"block text-sm font-semibold",children:"Pose ta question :"}),t.jsx("input",{id:"question",type:"text",className:"w-full p-2 mt-2 border rounded bg-gray-800",value:s,onChange:e=>n(e.target.value),placeholder:"Tape ici..."}),t.jsx("button",{className:"mt-4 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded disabled:bg-gray-600",onClick:r,disabled:a,children:a?"Chargement...":"Envoyer"})]})};x.__docgenInfo={description:"",methods:[],displayName:"AskGptChat",props:{REACT_APP_OPENAI_API_KEY:{required:!0,tsType:{name:"string"},description:""}}};export{x as AskGptChat};
